# USB2881 和自制数据采集平台上位机开发项目

## 目录

- [项目概述](#项目概述)
- [项目结构](#项目结构)
- [第三方库及现有代码功能](#第三方库及现有代码功能)
  - [第三方库](#第三方库)
  - [现有代码功能](#现有代码功能)
- [需求分析](#需求分析)
  - [系统需求](#系统需求)
  - [功能需求](#功能需求)
- [拟实现的功能](#拟实现的功能)
- [开发路线图](#开发路线图)
- [版本管理](#版本管理)
- [更新记录](#更新记录)
- [联系方式](#联系方式)

## 项目概述

本项目旨在基于现有的USB2881上位机软件，开发一款功能更加强大且扩展性更高的上位机软件，支持USB2881及自制的数据采集平台。新版本的软件将提供多设备管理、实时数据采集与显示、先进的数据处理与分析、优化的用户界面，以及更强的稳定性和性能，满足更广泛的应用需求。

## 项目结构

```
项目根目录/
├── build/ # 构建输出目录
│ └── ...
├── docs/ # 项目文档
│ ├── README.md # 项目说明文件
│ └── ...
├── include/ # 头文件目录
│ ├── CDataDevice.h # 设备抽象基类
│ ├── CUSB2881Device.h # USB2881设备类
│ ├── CDeviceManager.h # 设备管理类
│ └── ...
├── src/ # 源代码目录
│ ├── CDataDevice.cpp # 设备抽象基类实现
│ ├── CUSB2881Device.cpp # USB2881设备类实现
│ ├── CDeviceManager.cpp # 设备管理类实现
│ ├── main.cpp # 程序入口
│ ├── MainWindow.cpp # 主窗口类实现
│ ├── MainWindow.h # 主窗口类头文件
│ ├── DigitView.cpp # 数字视图类实现
│ ├── DigitView.h # 数字视图类头文件
│ ├── WaveView.cpp # 波形视图类实现
│ ├── WaveView.h # 波形视图类头文件
│ └── ...
├── forms/ # Qt Designer UI 文件
│ ├── MainWindow.ui # 主窗口UI文件
│ ├── ConfigurationDialog.ui # 配置对话框UI文件
│ └── ...
├── resources/ # 资源文件目录
│ ├── resources.qrc # Qt资源文件
│ ├── icons/ # 图标资源
│ └── ...
├── tests/ # 测试代码目录
│ └── ...
├── third_party/ # 第三方库目录
│ ├── Qt/ # Qt库
│ ├── USB2881_SDK/ # USB2881 SDK
│ └── ...
├── CMakeLists.txt # CMake构建脚本
└── ... # 其他项目文件
```

### 文件夹说明

- **build/**：存放项目的构建输出文件，如可执行文件、库文件等。
- **docs/**：存放项目相关的文档，包括 `README.md`、用户手册、开发文档等。
- **include/**：存放项目的头文件。包括设备抽象类、具体设备类及设备管理类等。
  - `CDataDevice.h`：设备抽象基类，定义所有设备通用的接口。
  - `CUSB2881Device.h`：USB2881设备类，继承自 `CDataDevice`，实现USB2881设备的具体功能。
  - `CDeviceManager.h`：设备管理类，负责管理多个设备实例的生命周期。
- **src/**：存放项目的源代码文件。包括设备类的实现、数据采集逻辑、可视化模块等。
  - `CDataDevice.cpp`：设备抽象基类的实现。
  - `CUSB2881Device.cpp`：USB2881设备类的实现。
  - `CDeviceManager.cpp`：设备管理类的实现。
  - `main.cpp`：程序的入口点。
  - `MainWindow.cpp` / `MainWindow.h`：主窗口类的实现及头文件。
  - `DigitView.cpp` / `DigitView.h`：数字视图类的实现及头文件。
  - `WaveView.cpp` / `WaveView.h`：波形视图类的实现及头文件。
  - `...`：其他源代码文件。
- **forms/**：存放Qt Designer设计的UI文件。
  - `MainWindow.ui`：主窗口的UI布局文件。
  - `ConfigurationDialog.ui`：配置对话框的UI布局文件。
  - `...`：其他UI文件。
- **resources/**：存放项目的资源文件，如图标、对话框模板、菜单等。
  - `resources.qrc`：Qt的资源文件，包含所有资源的引用。
  - `icons/`：图标资源目录。
  - `...`：其他资源文件。
- **tests/**：存放项目的测试代码，包括单元测试和集成测试。
- **third_party/**：存放第三方库，便于管理和更新。
  - `Qt/`：Qt库。
  - `USB2881_SDK/`：USB2881 SDK库。
  - `...`：其他第三方库。
- **CMakeLists.txt**：使用CMake作为构建系统时的配置脚本。
- **...**：其他项目相关的文件和文件夹。

### USB2881_SDK代码功能

- **设备管理 (Sys.cpp, Sys.h)**:
  - 初始化USB2881设备。
  - 管理设备生命周期，包括启动和停止数据采集。
- **数据采集 (ADFrm.cpp, ADDoc.cpp)**:
  - 管理数据采集线程，负责从设备读取数据。
  - 将采集到的数据存储到缓冲区，供处理和显示使用。
- **数字I/O控制 (DIODoc.cpp, DIOFrm.cpp, DIOView.cpp)**:
  - 控制和监控数字输入输出通道。
  - 提供用户界面用于切换数字输出和查看数字输入状态。
- **波形和数字数据可视化 (CADDigitView.cpp, CADWaveView.cpp)**:
  - 实时显示数字数据值和波形图。
  - 实现自定义控件以增强数据可视化效果。
- **历史数据管理 (ADHistDoc.cpp, ADHistFrm.cpp, ADHistDigitView.cpp, ADHistWaveView.cpp)**:
  - 将历史采集到的AD数据记录到文件中。
  - 提供界面以查看和分析历史数据。
- **参数配置 (ParaCfgView.cpp, ParaCfgView.h)**:
  - 提供接口供用户配置设备参数，如增益、输入范围和触发条件。
  - 实现设备校准功能，确保数据采集的准确性。
- **用户界面定制 (PopupMenu.cpp, CfgCtrlBar.cpp, TabCtrlBarDoc.cpp)**:
  - 自定义弹出菜单、工具栏和控制栏，提升用户交互体验。
- **数据处理工具 (QSortData.cpp, QSortData.h)**:
  - 实现数据排序和统计分析功能，如中位数、最大值、最小值等。
- **自定义示波器控件 (ADScopeCtrl.cpp, ADScopeCtrl.h)**:
  - 实现高性能的实时波形绘制，支持缩放和平移操作。
- **MDI客户端管理 (MdiClient.cpp, MdiClient.h)**:
  - 实现多文档接口（MDI）的客户端窗口，支持标签式管理多个子窗口。
- **主框架窗口 (MainFrm.cpp, MainFrm.h)**:
  - 管理主界面元素，如工具栏、状态栏和MDI标签管理器。
  - 处理主菜单命令，如启动/停止设备采集、设备校准等。

## 需求分析

### 系统需求

- **操作系统**：Windows 7 或更高版本（32位或64位）
- **处理器**：Intel Core i5 或同等
- **内存**：最低4 GB RAM（推荐8 GB）
- **存储空间**：至少500 MB可用磁盘空间
- **编译器**：Microsoft Visual Studio 2017 或更高版本
- **库**：MFC、Windows API、USB2881 SDK

### 功能需求

- **多设备支持**：
  - 支持USB2881及其他自制数据采集设备。
  - 能够同时管理多个设备进行数据采集。
- **实时数据采集与显示**：
  - 高速数据采集，确保实时性。
  - 实时显示波形图和数字化数据。
- **先进的数据处理与分析**：
  - 实现数据过滤、噪声抑制和信号处理算法。
  - 提供统计分析工具，如均值、标准差和频率测量。
- **优化的用户界面**：
  - 现代化和直观的GUI设计，提升用户体验。
  - 支持动态添加/移除设备和视图。
- **历史数据管理**：
  - 高效存储和检索历史数据。
  - 提供高级搜索和过滤选项，便于数据分析。
- **设备校准与配置**：
  - 用户友好的设备校准接口。
  - 完善的设备参数配置选项。
- **扩展性与可维护性**：
  - 模块化代码结构，确保低耦合高内聚。
  - 易于扩展的架构，支持未来新增设备和功能模块。
- **性能与稳定性**：
  - 优化数据采集和处理的性能。
  - 具备稳健的错误处理和恢复机制。

## 拟实现的功能

基于现有的功能和需求分析，新上位机软件将实现以下功能：

- **增强的多设备管理**：
  - 统一界面管理多个USB2881和自制设备。
  - 实时监控设备状态。
- **高级数据可视化**：
  - 支持高分辨率波形显示，具备缩放和平移功能。
  - 交互式数字数据表，支持排序和过滤。
- **全面的数据分析工具**：
  - 内置信号处理算法（如FFT分析、滤波）。
  - 可定制的统计报告，提供详细的统计指标。
- **用户友好的参数配置**：
  - 简化设备配置对话框，便于参数调整和校准。
  - 提供不同数据采集场景的预设配置。
- **稳健的历史数据处理**：
  - 实现高效的数据压缩与存储格式。
  - 增强的历史数据检索与分析工具。
- **现代化和可定制的用户界面**：
  - 响应式设计，适应不同屏幕分辨率。
  - 主题和可定制布局，提升用户体验。
- **与第三方工具的无缝集成**：
  - 支持外部工具（如Excel、MATLAB）的数据导出选项。
- **增强的稳定性和错误处理**：
  - 优化多线程机制，防止数据丢失并确保实时性能。
  - 实现详细的日志记录系统，便于故障排查和系统监控。

## 开发路线图

### 阶段1：规划与设置

- **任务1**：使用Git设置版本控制。
- **任务2**：定义架构并模块化代码库。
- **任务3**：审查现有代码并记录当前功能。

### 阶段2：设备管理增强

- **任务1**：实现设备抽象层，定义 `CDataDevice` 基类。
- **任务2**：开发 `CUSB2881Device` 和 `CCustomDevice` 类。
- **任务3**：实现 `CDeviceManager` 类，管理多个设备实例。

### 阶段3：实时数据采集与处理

- **任务1**：重构数据采集线程，提升性能和稳定性。
- **任务2**：实现高级数据处理算法。
- **任务3**：优化数据缓冲和传输机制。

### 阶段4：高级数据可视化

- **任务1**：优化现有的 `CADDigitView` 和 `CADWaveView`，提高性能。
- **任务2**：集成高级UI控件，增强数据交互。
- **任务3**：实现多设备视图的动态管理。

### 阶段5：历史数据管理

- **任务1**：设计高效的数据存储格式。
- **任务2**：实现历史数据的读取和分析功能。
- **任务3**：开发高级查询和过滤接口。

### 阶段6：用户界面改进

- **任务1**：重新设计用户界面，提升可用性和现代感。
- **任务2**：实现可定制的布局和主题。
  - 🛠 **任务2.1**：添加主题选择功能。
  - 🛠 **任务2.2**：允许用户保存和加载自定义布局。
- **任务3**：添加交互元素，如工具提示、状态栏和菜单。

### 阶段7：测试与质量保证

- **任务1**：编写所有新模块的单元测试。
- **任务2**：进行集成测试，确保模块兼容性。
- **任务3**：执行性能测试并优化瓶颈部分。

### 阶段8：文档与部署

- **任务1**：创建详细的用户手册和开发文档。
- **任务2**：准备软件部署的安装包。
- **任务3**：为用户和支持团队提供培训课程。

## 版本管理

本项目采用**语义化版本控制**（Semantic Versioning）。

## 更新记录

### v0.1.0 - 初始版本

- 基本的USB2881设备支持。
- 实时AD数据采集与显示。
- 数字I/O控制接口。
- 自定义波形可视化。
- 历史数据记录与基础分析。

备注
代码结构维护：确保项目仓库结构清晰，源码、文档、第三方库及构建脚本分别存放于不同目录中。
持续集成与部署：建议使用CI/CD工具（如GitHub Actions、Jenkins）实现自动化构建和测试，以维护代码质量和简化开发流程。
文档更新：每次代码更新后，及时在README.md中记录版本变化及更新内容，确保文档与代码同步。
---------------------------------------------------------------------------------------

## 联系方式

- **开发团队**：Your Company Name
- **负责人**：张三
- **邮箱**：zhangsan@example.com
- **电话**：+86 10 1234 5678
- **地址**：北京市海淀区XX路XX号

---

**说明**：

1. **项目结构部分**：

   - **build/**：用于存放构建输出的文件，如可执行文件、库文件等。
   - **docs/**：存放项目相关的文档，包括 `README.md`、用户手册、开发文档等。
   - **include/**：存放项目的头文件。包括设备抽象类、具体设备类、设备管理类等。
   - **src/**：存放项目的源代码文件。包括设备类的实现、数据采集逻辑、可视化模块等。
   - **resources/**：存放项目的资源文件，如图标、对话框模板、菜单等。
   - **tests/**：用于存放项目的测试代码，包括单元测试和集成测试。
   - **third_party/**：存放第三方库，便于管理和更新。
   - **CMakeLists.txt**：如果使用CMake作为构建系统，存放CMake构建脚本。
2. **文件夹命名**：

   - 使用英文命名可以提高代码的可移植性和团队协作效率，建议主要使用英文命名。
   - 保持文件夹和文件命名的一致性和描述性，便于快速理解其功能。
3. **持续更新**：

   - 每次对项目进行重大修改或添加新功能后，立即在 `更新记录` 中记录具体的变更内容和版本号。
   - 保持 `项目结构` 部分与实际项目文件夹结构同步，确保文档准确反映项目的当前状态。

请按照上述建议更新您的项目文件夹和文件结构。如果有任何问题或需要进一步的指导，请随时告知！

---

**祝项目开发顺利！**
